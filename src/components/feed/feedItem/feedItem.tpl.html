<md-card ng-if="feedItemCtrl.event.space!=null || feedItemCtrl.event.eventType == 'REMOVE'" ng-init="feedItemCtrl.separateChanges(feedItemCtrl.event.changeset.changes)" class="feed-item-card verticalLine">

    <md-card-header class="attribute-changed-header">
        <md-card-avatar>
            <img class="md-user-avatar" src="http://www.fillmurray.com/g/200/200">
        </md-card-avatar>
        <md-card-header-text>
            <div class="md-title" layout="row" layout-align="space-between start">
                <div>{{ feedItemCtrl.event.user.name }}</div>
                <div>{{ feedItemCtrl.event.changeset.when }}</div>
            </div>
            <div class="md-subhead" layout="row">
                    <div class="link-breadcrumb" ng-href="http://localhost:8000/#/workspaces/{{feedItemCtrl.event.space.id}}">
                        {{feedItemCtrl.event.space.name}}
                    </div>
                    <div class="link-breadcrumb" ng-if="feedItemCtrl.event.space==null">
                        [Workspace deleted]
                    </div>
                    <div>
                        <md-icon ng-if="feedItemCtrl.event.changeset.entity != null || feedItemCtrl.event.changeset.changes.property == null && feedItemCtrl.event.eventType == 'CHANGE'" class="material-icons">chevron_right</md-icon>
                    </div>
                    <div ng-if="feedItemCtrl.event.changeset.path != null" ng-repeat="path in feedItemCtrl.event.changeset.path">
                        <a class="link-breadcrumb">
                            {{path.name}}
                        </a>
                        <a>
                            <md-icon ng-if="path != null" class="material-icons">chevron_right</md-icon>
                        </a>
                    </div>
                    <div class="link-breadcrumb" ng-href="http://localhost:8000/#/entities/{{feedItemCtrl.event.changeset.entity.id}}">
                        {{feedItemCtrl.event.changeset.entity.name}}
                        <a ng-if="feedItemCtrl.event.changeset.entity.type!=null">:</a>
                        {{feedItemCtrl.event.changeset.entity.type}}
                    </div>
                    <div class="link-breadcrumb" ng-if="feedItemCtrl.event.eventType == 'CHANGE' && feedItemCtrl.event.changeset.entity == null && feedItemCtrl.event.changeset.changes.property == null">
                        [Entity deleted]
                    </div>
            </div>
        </md-card-header-text>
    </md-card-header>

    <md-divider></md-divider>

    <sc-simple-value-changes ng-if="feedItemCtrl.simpleValueChanges.length" sc-changes="feedItemCtrl.simpleValueChanges" sc-entity="feedItemCtrl.event.changeset.entity"></sc-simple-value-changes>

    <sc-rich-string-changes ng-if="feedItemCtrl.richStringChanges.length" sc-changes="feedItemCtrl.richStringChanges" sc-entity="feedItemCtrl.event.changeset.entity"></sc-rich-string-changes>

    <sc-role-changes ng-if="feedItemCtrl.roleChanges.length" sc-changes="feedItemCtrl.roleChanges" sc-entity="feedItemCtrl.event.changeset.entity"></sc-role-changes>

    <md-card-title ng-if="feedItemCtrl.event.eventType == 'CHANGE' && !feedItemCtrl.event.changeset.changes.length" layout="row" layout-align="space-between centre">
        <h2>
            <i>Entity has been deleted.</i>
        </h2>
    </md-card-title>

    <md-card-title ng-if="feedItemCtrl.event.eventType == 'ADD'">
        <h2 ng-if="feedItemCtrl.event.changeset.entity.type != null ">
            Added the {{feedItemCtrl.event.changeset.entity.type}}:
            <a class="link-change" ng-href="http://localhost:8000/#/entities/{{feedItemCtrl.event.changeset.entity.id}}">{{feedItemCtrl.event.changeset.entity.name}}</a>
        </h2>
        <h2 ng-if="feedItemCtrl.event.changeset.entity.type == null">
            Added the workspace:
            <a class="link-change" ng-href="http://localhost:8000/#/workspaces/{{feedItemCtrl.event.space.id}}">{{feedItemCtrl.event.space.name}}</a>
        </h2>
    </md-card-title>

    <md-card-title ng-if="feedItemCtrl.event.eventType == 'REMOVE'">
        <h2 ng-if="feedItemCtrl.event.space!=null">
            An entity has been removed from
            <a class="link-change" ng-href="http://localhost:8000/#/workspaces/{{feedItemCtrl.event.space.id}}">{{feedItemCtrl.event.space.name}}</a>.
        </h2>
        <h2 ng-if="feedItemCtrl.event.space==null">
            A workspace has been removed.
        </h2>
    </md-card-title>

    <md-divider></md-divider>

    <md-card-actions layout="row" layout-align="start center">
        <md-button aria-label="Favorite">
            <md-icon class="material-icons">favorite</md-icon>
        </md-button>
        <md-button aria-label="Comment">
            <md-icon class="material-icons">comment</md-icon>
        </md-button>
    </md-card-actions>

</md-card>
